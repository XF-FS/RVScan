# RVScan - Burp Suite 扩展插件

RVScan 是一个功能强大的 Burp Suite 扩展插件，专为自动化Web应用程序安全测试和漏洞扫描而设计。它提供全面的路径发现、绕过技术、EHole指纹识别和可定制的扫描规则。

## 项目概述

这是一个基于Java的Burp Suite扩展插件，自动化执行隐藏路径发现、绕过技术测试、Web应用程序指纹识别和漏洞扫描。该扩展与Burp Suite的被动和主动扫描功能无缝集成。

## 核心功能

### 🔍 **自动化路径发现**
- 基于可配置规则的智能路径枚举
- 多线程扫描提升性能
- 去重机制避免冗余请求

### 🛡️ **高级绕过技术**
- **路径绕过**: URL编码和路径操作 (`%2f`, `%2e`)
- **前缀路径绕过**: CSS/JS目录遍历 (`css/..;/..;`, `..;`, `js/..;/..;`)
- **后缀路径绕过**: 文件扩展名操作 (`;.js`, `.json`, `.js`)

### 🎯 **EHole指纹识别系统**
- **EHole兼容**: 完全兼容EHole官方指纹格式
- **智能识别**: 自动识别CMS、框架、中间件和应用程序
- **多种匹配方式**: 支持body、header、title、faviconhash四种匹配位置
- **高级匹配逻辑**: 支持AND(&&)、OR(||)、正则表达式和否定匹配
- **Favicon哈希**: 基于MurmurHash3算法的favicon指纹识别
- **编码自适应**: 自动检测和处理中文编码（UTF-8、GBK、GB2312）
- **缓存优化**: 避免重复扫描，提升性能
- **独立控制**: 指纹扫描与漏洞扫描独立开关控制

### ⚙️ **灵活配置**
- 基于YAML的规则配置
- 从GitHub仓库在线更新规则
- 自定义线程池管理
- 支持通配符的主机过滤

### 🔎 **智能扫描模式**
- **被动扫描**: 自动扫描拦截的请求
- **右键菜单集成**: 从任何Burp工具右键扫描
- **强制扫描**: 完整路径扫描，无去重
- **域名扫描**: 全面的子域名分析

## EHole指纹识别功能详解

### 🎯 **功能特性**

#### **多维度指纹识别**
- **响应体匹配**: 识别HTML、JavaScript、CSS等内容特征
- **响应头匹配**: 检测Server、X-Powered-By等服务器信息
- **标题匹配**: 分析HTML页面标题的特征关键词
- **Favicon哈希**: 基于网站图标的唯一哈希值识别

#### **高级匹配算法**
- **关键词组合**: 支持多关键词AND逻辑，所有关键词必须同时匹配
- **正则表达式**: 使用`regex:`前缀支持复杂模式匹配
- **否定匹配**: 使用`!`前缀排除特定内容
- **状态码过滤**: 根据HTTP响应状态码精确匹配

#### **智能扫描策略**
- **路径扫描**: 对当前访问路径、根路径和配置路径进行指纹识别
- **缓存机制**: 每个URL只扫描一次，避免重复请求
- **编码处理**: 自动检测响应编码，正确处理中文内容
- **性能优化**: 静态资源自动跳过，专注于动态页面

### 📁 **配置文件和目录结构**

#### **主要配置文件**
```
RouteVulScan_kiro/
├── finger.json              # EHole指纹库文件
├── Config_yaml.yaml         # 主配置文件
├── src/main/java/
│   ├── fingerprint/         # 指纹识别模块
│   │   ├── FingerPrint.java       # 指纹数据结构
│   │   ├── FingerprintMatcher.java # 指纹匹配引擎
│   │   ├── FingerprintScanner.java # 指纹扫描器
│   │   ├── FingerprintLoader.java  # 指纹库加载器
│   │   └── FingerprintConfig.java  # 指纹配置界面
│   └── burp/                # 主扩展模块
└── build/libs/              # 编译输出目录
```
